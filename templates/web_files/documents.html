
{% extends 'reused_templates/base.html' %}

{% load static %} {% load custom_filters %}

{% block td_nav %}
  <td style="padding: 0 10px;"><a href="/display/{{db}}" class="nav">Collections</a></td>
  {% if model %}
    <td style="padding: 0 10px;">
      <a href="/add/{{db}}/{{collection}}" style="color: grey;" class="nav">Add Document</a>
    </td>
    <td style="padding: 0 10px;">
      <a href="/doc_model/{{db}}/{{collection}}" style="color: grey;" class="nav">Update Model</a>
    </td>
    <td style="padding: 0 10px; color: orange;">
      <a href="/filter/{{db}}/{{collection}}" style="color: grey;" class="nav">Filter</a>
    </td>
    <td style="padding: 0 10px; color: orange;">
      <a href="/sort/{{db}}/{{collection}}" style="color: grey;" class="nav">Sort</a>
    </td>
  {% endif %}
{% endblock %}

{% block h %}
  <h2>Documents of collection '{{collection}}'<br>
    {% if num %}
      {{num}}/{{docs_len}}
    {% else %}
      <form action="" method="POST" name="clear_form">
        {% csrf_token %}
        <input type="submit" class="button" value="Clear all" name="clear">
      </form>
    {% endif %}
  </h2>
{% endblock %}

{% block content %}
  <table style="margin: auto;">
    {% if model and docs %}
      <tr>
        {% for attr_dict in model.values %}
          <td style="padding: 10px">
            <h3 style="color: blue;">{{attr_dict.name}}</h3>
          </td>
        {% endfor %}
      </tr>
      <tr>
        {% for attr_dict in model.values %}
          <td style="padding: 10px">
            <h3 style="color: red;">({{attr_dict.type}})</h3>
          </td>
        {% endfor %}
      </tr>
      {% for doc in docs %}
        <tr>
          {% for attr_dict in model.values %}
            <td style="padding: 10px">{{doc|lookup:attr_dict.name}}</td>
          {% endfor %}
          <td style="padding: 0 5px;">
            <form action="/update/{{db}}/{{collection}}/{{doc.id}}" method="GET">
              <button type="submit" class="img_button">
                <img src="{% static 'icons/edit.ico' %}" alt="update" width="35px" height="35px">
              </button>
            </form>
          </td>
          <td style="padding: 0 5px;">
            <form action="/delete/{{db}}/{{collection}}/{{doc.id}}" method="GET">
              <button type="submit" class="img_button">
                <img src="{% static 'icons/delete.ico' %}" alt="delete" width="35px" height="35px">
              </button>
            </form>
          </td>
        </tr>
      {% endfor %}
    {% else %}
      {% for doc in docs %}
        <tr>
          <td style="text-align: left;">
            <pre style="white-space: pre-wrap; word-break: break-all;"><div style="color: red;">{{forloop.counter}}:</div> {{doc}}</pre>
          </td>
        </tr>
      {% endfor %}
      {% if show_more %}
        <tr>
          <td style="padding: 0 5px;">
            <form action="/display/{{db}}/{{collection}}" method="GET">
              <button type="submit" class="button" style="padding: 1px 3px; margin: 0;" name="show_more" value="{{num}}">
                <img src="{% static 'icons/add.ico' %}" alt="show_more" width="25px" height="25px">
              </button>
            </form>
          </td>
        </tr>
      {% endif %}
    {% endif %}
  </table>
{% endblock %}