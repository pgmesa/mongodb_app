<!DOCTYPE html>
<html>
    {% load static %} {% load custom_filters %}
  <head>
    <meta charset="utf-8">
    <meta name="author" content="Pablo GarcÃ­a Mesa"> 
    <title>MongoDB App</title>
    <link rel="icon" href="{% static 'icons/mongodb.ico' %}">
    <!-- Para incluir esta plamtilla hay que poner el dir de plantillas
    en los settings.py de django (TEMPLATES.DIRS)-->
    {% if 'light'|is_theme %}
      <link rel="stylesheet" href="{% static 'css/light_theme/general_design.css' %}">
      <link rel="stylesheet" href="{% static 'css/light_theme/buttons.css' %}">
      <link rel="stylesheet" href="{% static 'css/light_theme/links.css' %}">
      <link rel="stylesheet" href="{% static 'css/light_theme/selects.css' %}">
      <link rel="stylesheet" href="{% static 'css/light_theme/inputs.css' %}">
      <link rel="stylesheet" href="{% static 'css/light_theme/text_classes.css' %}">
      <link rel="stylesheet" href="{% static 'css/light_theme/scrollbox.css' %}">
    {% elif 'dark'|is_theme %}
      <link rel="stylesheet" href="{% static 'css/dark_theme/general_design.css' %}">
      <link rel="stylesheet" href="{% static 'css/dark_theme/buttons.css' %}">
      <link rel="stylesheet" href="{% static 'css/dark_theme/links.css' %}">
      <link rel="stylesheet" href="{% static 'css/dark_theme/selects.css' %}">
      <link rel="stylesheet" href="{% static 'css/dark_theme/inputs.css' %}">
      <link rel="stylesheet" href="{% static 'css/dark_theme/text_classes.css' %}">
      <link rel="stylesheet" href="{% static 'css/dark_theme/scrollbox.css' %}">
    {% endif %}
    <link rel="stylesheet" href="{% static 'css/toggle_switch.css' %}">

    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        let slider = document.getElementById('slider');
        slider.onchange = () => {
          let theme_form = document.getElementById('theme_form');
          let input = document.createElement('input');
          input.name = "toggle_theme"; input.type = "text";
          theme_form.appendChild(input);
          theme_form.submit();
        }
      })
    </script>

    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        const id = "{{id_to_scroll}}";
        element = document.getElementById(id);
        // behavior = 'smooth'
        let behavior = "auto";
        element.scrollIntoView({"block": "center", "behavior": behavior});
        //alert(window.scrollY)
      })
    </script>

    <script>
      window.onresize = () => {
        location.reload();
      }
    </script>

    {% block js %}
    {% endblock %}

  </head>

  <body>
    <header>
      <table style="margin: auto;">
        <tr>
          <td>
            <img src="{% static 'icons/mongodb.ico' %}" alt="No se ha encontrado el logo" height="70px" width="70px">
          </td>
          <td>
            <h1>MongoDB App</h1>
          </td>
        </tr>
      </table>
      {% if change_theme %}
        <table style="margin: auto;">
          <tr>
            <td>Theme:  </td>
            <td>
              <label class="switch">
                <form action="" method="POST" id="theme_form">
                  {% csrf_token %}
                  <input type="checkbox" id="slider" name="toggle_theme" {% if 'dark'|is_theme %}checked{% endif %}>
                  <span class="slider round"></span>
                </form>
              </label>
            </td>
            <td style="padding-left: 5px;">
              {% if 'dark'|is_theme %}
                <img src="{% static 'icons/moon.ico' %}" width="35px" height="35px" alt="Dark Theme">
              {% elif 'light'|is_theme %}
                <img src="{% static 'icons/sun.ico' %}" width="35px" height="35px" alt="Light Theme">
              {% endif %}
            </td>
          </tr>
        </table>
      {% endif %}
    </header>

    <nav style="z-index: 1;">
      <table style="margin: auto;">
        <tr>
          <td style="padding: 0 10px;">
            <a class="nav_goback" href="{% url 'home' %}">Home</a>
          </td>
          {% block td_nav %}
          {% endblock %}
        </tr>
      </table> 
    </nav>

    {% if msg or err_msg or warning %}
      <nav style="padding-bottom: 1%; z-index: 1;" class="msg">
        {% block msg %}
          <table style="width: 100%;">
            {% if msg %}
              {% if conserv_format %}
                <pre style="white-space: pre-wrap; word-break: break-all;"><h3 class="success">{{msg}}</h3></pre>
              {% else %}
                <tr>
                  <td class="success" style="font-size: 20px;"><h3>{{msg}}</h3></td>
                </tr>
              {% endif %}
            {% endif %}
            {% if warning %}
              {% if conserv_format %}
                <pre style="white-space: pre-wrap; word-break: break-all;"><h3 class="warning">WARNING: {{warning}}</h3></pre>
              {% else %}
                <tr>
                  <td class="warning" style="font-size: 20px;"><h3>WARNING: {{warning}}</h3></td>
                </tr>
              {% endif %}
            {% endif %}
            {% if err_msg %}
              {% if conserv_format %}
                <pre style="white-space: pre-wrap; word-break: break-all;"><h3 class="error">{{err_msg}}</h3></pre>
              {% else %}
                <tr>
                  <td class="error" style="font-size: 20px;"><h3>{{err_msg}}</h3></td>
                </tr>
              {% endif %}
            {% endif %}
          </table>
        {% endblock %}
        </nav>
    {% endif %}

    
    <div style="padding: 1%;" id="main_content">
      {% block h %}
      {% endblock %}
    </div>
      
    <div id="main_content">
      {% block content %} 
      {% endblock %}
    </div>

    <footer>
      <p>Made by: Pablo Garcia Mesa</p>
    </footer>
    
  </body>
</html>